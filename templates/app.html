<!DOCTYPE html>
<html>

<head>
    <title>Bangalore Home Price Prediction</title>
    <!-- Leaflet CSS must come before JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='app.css') }}">

    <!-- JavaScript dependencies -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/heatmap.js@2.0.5/build/heatmap.min.js"></script>
    <script src="https://leaflet.github.io/Leaflet.heat/dist/leaflet-heat.js"></script>
    <!-- Load our app.js last -->
    <script src="{{ url_for('static', filename='app.js') }}"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>

<body>
    <div class="header">
        <div class="logo">
            <i class="fas fa-home"></i> Bangalore Property Predictor
        </div>
        <div class="user-panel">
            <button id="loginBtn" class="auth-btn"><i class="fas fa-sign-in-alt"></i> Login</button>
            <button id="registerBtn" class="auth-btn"><i class="fas fa-user-plus"></i> Register</button>
            <div id="userInfo" class="user-info hidden">
                <span id="username">User</span>
                <button id="logoutBtn" class="auth-btn small"><i class="fas fa-sign-out-alt"></i></button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="sidebar">
            <div class="form-container">
                <h2>Property Details</h2>
                <form class="form" id="predictionForm">
                    <div class="form-group">
                        <label for="uiSqft"><i class="fas fa-ruler-combined"></i> Area (Square Feet)</label>
                        <input class="area" type="text" id="uiSqft" name="Squareft" value="1000">
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-building"></i> BHK</label>
                        <div class="switch-field">
                            <input type="radio" id="radio-bhk-1" name="uiBHK" value="1" />
                            <label for="radio-bhk-1">1</label>
                            <input type="radio" id="radio-bhk-2" name="uiBHK" value="2" checked />
                            <label for="radio-bhk-2">2</label>
                            <input type="radio" id="radio-bhk-3" name="uiBHK" value="3" />
                            <label for="radio-bhk-3">3</label>
                            <input type="radio" id="radio-bhk-4" name="uiBHK" value="4" />
                            <label for="radio-bhk-4">4</label>
                            <input type="radio" id="radio-bhk-5" name="uiBHK" value="5" />
                            <label for="radio-bhk-5">5</label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-bath"></i> Bath</label>
                        <div class="switch-field">
                            <input type="radio" id="radio-bath-1" name="uiBathrooms" value="1" />
                            <label for="radio-bath-1">1</label>
                            <input type="radio" id="radio-bath-2" name="uiBathrooms" value="2" checked />
                            <label for="radio-bath-2">2</label>
                            <input type="radio" id="radio-bath-3" name="uiBathrooms" value="3" />
                            <label for="radio-bath-3">3</label>
                            <input type="radio" id="radio-bath-4" name="uiBathrooms" value="4" />
                            <label for="radio-bath-4">4</label>
                            <input type="radio" id="radio-bath-5" name="uiBathrooms" value="5" />
                            <label for="radio-bath-5">5</label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="uiLocations"><i class="fas fa-map-marker-alt"></i> Location</label>
                        <select id="uiLocations" onchange="updateMapLocation()">
                            <option value="" disabled selected>Choose a Location</option>
                        </select>


                        <button type="button" id="mapSelectBtn" class="map-btn"><i class="fas fa-map"></i> Select on
                            Map</button>
                    </div>

                    <div class="form-group">
                        <label for="uiPropertyAge"><i class="fas fa-calendar-alt"></i> Property Age (Years)</label>
                        <div class="range-container">
                            <input type="range" id="uiPropertyAge" min="0" max="20" value="0" class="slider">
                            <span id="propertyAgeValue">0</span>
                        </div>
                    </div>

                    <button class="submit" id="estimateBtn" type="button">
                        <i class="fas fa-calculator"></i> Estimate Price
                    </button>

                    <div id="uiEstimatedPrice" class="result">
                        <h2></h2>
                    </div>


                    <button class="favorite-btn hidden" id="saveFavoriteBtn" type="button" onclick="saveFavorite()">
                        <i class="far fa-heart"></i> Save to Favorites
                    </button>

                </form>
            </div>
        </div>

        <div class="main-content">
            <div class="tabs">
                <button class="tab-btn active" data-tab="map">Map View</button>
                <button class="tab-btn" data-tab="favorites" onclick="loadFavorites()">Saved Properties</button>
                <button class="tab-btn" data-tab="about">About Project</button>
            </div>

            <div class="tab-content">
                <!-- About Tab -->
                <div id="about-tab" class="tab-pane">
                    <div class="about-section">
                        <div class="about-header">
                            <h2><i class="fas fa-info-circle"></i> About Bangalore Property Predictor</h2>
                            <p>An intelligent real estate valuation platform powered by Machine Learning.</p>
                        </div>

                        <div class="about-grid">
                            <div class="info-card">
                                <h3><i class="fas fa-project-diagram"></i> Project Introduction</h3>
                                <p>The Bangalore House Price Predictor is a data-driven application designed to provide
                                    accurate property valuation estimates in Bangalore. By leveraging historical real
                                    estate data and advanced machine learning algorithms, it helps users understand
                                    market trends and make informed investment decisions.</p>
                            </div>

                            <div class="info-card">
                                <h3><i class="fas fa-scope"></i> Project Scope</h3>
                                <p>The platform focuses on residential properties across Bangalore. It analyzes factors
                                    like total area (sqft), number of bedrooms (BHK), bathrooms, and property age. The
                                    scope includes real-time amenity discovery (schools, hospitals, etc.) and
                                    location-based price adjustments driven by our predictive model.</p>
                            </div>

                            <div class="info-card wide">
                                <h3><i class="fas fa-microchip"></i> System Architecture & Flow</h3>
                                <div class="flow-container">
                                    <div class="flow-step">
                                        <i class="fas fa-keyboard"></i>
                                        <span>User Input</span>
                                    </div>
                                    <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
                                    <div class="flow-step">
                                        <i class="fas fa-cogs"></i>
                                        <span>Flask Backend</span>
                                    </div>
                                    <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
                                    <div class="flow-step">
                                        <i class="fas fa-brain"></i>
                                        <span>RF Model</span>
                                    </div>
                                    <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
                                    <div class="flow-step">
                                        <i class="fas fa-chart-line"></i>
                                        <span>Price Prediction</span>
                                    </div>
                                    <div class="flow-arrow"><i class="fas fa-long-arrow-alt-right"></i></div>
                                    <div class="flow-step">
                                        <i class="fas fa-map-marked-alt"></i>
                                        <span>Interactive UI</span>
                                    </div>
                                </div>
                                <p class="flow-desc">Our architecture uses a <strong>Random Forest Regressor</strong>
                                    trained on a cleaned dataset of 13,000+ listings. The frontend communicates with a
                                    <strong>Flask API</strong> to provide sub-second predictions and dynamic map updates
                                    via <strong>Leaflet.js</strong>.
                                </p>
                            </div>
                        </div>

                        <div class="team-section">
                            <h3><i class="fas fa-users"></i> Our Team & Contributions</h3>
                            <div class="team-grid">
                                <div class="team-card">
                                    <div class="team-avatar"><i class="fas fa-user-circle"></i></div>
                                    <h4>Devang Nadkarni</h4>
                                    <p class="team-role">System Architect Developer</p>
                                    <p class="team-contrib">ML model optimization, deployment configuration, and UI/UX
                                        Architecture.</p>
                                    <div class="team-links">
                                        <a href="https://www.linkedin.com/in/devang-nadkarni-79066a319"
                                            target="_blank"><i class="fab fa-linkedin"></i></a>
                                        <a href="mailto:nadkarnidevang@gmail.com"><i class="fas fa-envelope"></i></a>
                                    </div>
                                </div>
                                <div class="team-card">
                                    <div class="team-avatar"><i class="fas fa-user-circle"></i></div>
                                    <h4>Yuvraj Mangutkar</h4>
                                    <p class="team-role">Data Engineer</p>
                                    <p class="team-contrib">Data Preprocessing, Feature Engineering, and Model Training
                                        logic.</p>
                                    <div class="team-links">
                                        <a href="https://www.linkedin.com/in/yuvraj-mangutkar?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app"
                                            target="_blank"><i class="fab fa-linkedin"></i></a>
                                        <a href="mailto:mangutkaryuvraj@gmail.com"><i class="fas fa-envelope"></i></a>
                                    </div>
                                </div>
                                <div class="team-card">
                                    <div class="team-avatar"><i class="fas fa-user-circle"></i></div>
                                    <h4>Sujit Kale</h4>
                                    <p class="team-role">Front End Developer</p>
                                    <p class="team-contrib">UI/UX Design, Map Integration, and Responsive Layout
                                        development.</p>
                                    <div class="team-links">
                                        <a href="#"><i class="fab fa-linkedin"></i></a>
                                        <a href="#"><i class="fas fa-envelope"></i></a>
                                    </div>
                                </div>
                                <div class="team-card">
                                    <div class="team-avatar"><i class="fas fa-user-circle"></i></div>
                                    <h4>Manav Konde</h4>
                                    <p class="team-role">Quality Analyst</p>
                                    <p class="team-contrib">Documentation, system testing, research analysis, and
                                        quality assurance.</p>
                                    <div class="team-links">
                                        <a href="https://www.linkedin.com/in/manav-konde-9b23242b1?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app"
                                            target="_blank"><i class="fab fa-linkedin"></i></a>
                                        <a href="mailto:manavkonde01@gmail.com"><i class="fas fa-envelope"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Favorites Tab -->
                <div id="favorites-tab" class="tab-pane">
                    <div class="favorites-header">
                        <h3><i class="fas fa-heart"></i> Your Saved Properties</h3>
                        <button id="compareBtn" class="action-btn" onclick="compareProperties()"><i
                                class="fas fa-balance-scale"></i> Compare Selected</button>
                    </div>
                    <div id="favoritesList" class="favorites-grid">
                        <p class="placeholder-text">Log in to save and view your favorite properties.</p>
                    </div>
                </div>

                <!-- Comparison Modal -->
                <div id="compareModal" class="modal">
                    <div class="modal-content large-modal">
                        <span class="close">&times;</span>
                        <h2>Property Comparison</h2>
                        <div id="comparisonContainer"></div>
                    </div>
                </div>

                <div id="map-tab" class="tab-pane active">
                    <div class="map-amenities-wrapper">
                        <div class="map-container">
                            <div id="mapView"></div>
                            <div class="map-overlay"></div>
                        </div>

                        <div class="nearby-amenities-section">
                            <div class="section-header">
                                <h3><i class="fas fa-search-location"></i> Nearby Amenities</h3>
                                <p>Explore what's around your selected property</p>
                            </div>

                            <div class="amenities-filter-row">
                                <button class="amenity-btn" onclick="fetchNearbyPlaces('school')"><i
                                        class="fas fa-school"></i> Schools</button>
                                <button class="amenity-btn" onclick="fetchNearbyPlaces('hospital')"><i
                                        class="fas fa-hospital-alt"></i> Hospitals</button>
                                <button class="amenity-btn" onclick="fetchNearbyPlaces('restaurant')"><i
                                        class="fas fa-utensils"></i> Restaurants</button>
                                <button class="amenity-btn" onclick="fetchNearbyPlaces('mall')"><i
                                        class="fas fa-shopping-bag"></i> Malls</button>
                            </div>

                            <div id="nearbyList" class="amenities-grid">
                                <div class="placeholder-text">Select an amenity type to see nearby places.</div>
                            </div>
                        </div>
                    </div>

                    <!-- Authentication Modal -->
                    <div id="authModal" class="modal">
                        <div class="modal-content">
                            <span class="close">&times;</span>
                            <div class="auth-tabs">
                                <button class="auth-tab-btn active" data-tab="login">Login</button>
                                <button class="auth-tab-btn" data-tab="register">Register</button>
                            </div>

                            <div id="login-tab" class="auth-tab-pane active">
                                <form id="loginForm" class="auth-form">
                                    <div class="form-group">
                                        <label for="loginEmail"><i class="fas fa-envelope"></i> Email</label>
                                        <input type="email" id="loginEmail" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="loginPassword"><i class="fas fa-lock"></i> Password</label>
                                        <input type="password" id="loginPassword" required>
                                    </div>
                                    <button type="submit" class="auth-submit-btn">Login</button>
                                </form>
                            </div>

                            <div id="register-tab" class="auth-tab-pane">
                                <form id="registerForm" class="auth-form">
                                    <div class="form-group">
                                        <label for="regName"><i class="fas fa-user"></i> Name</label>
                                        <input type="text" id="regName" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="regEmail"><i class="fas fa-envelope"></i> Email</label>
                                        <input type="email" id="regEmail" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="regPassword"><i class="fas fa-lock"></i> Password</label>
                                        <input type="password" id="regPassword" required>
                                    </div>
                                    <button type="submit" class="auth-submit-btn">Register</button>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Map Selection Modal -->
                    <div id="mapSelectionModal" class="modal">
                        <div class="modal-content map-modal">
                            <span class="close">&times;</span>
                            <h2>Select Location on Map</h2>
                            <div id="selectionMap" class="selection-map"></div>
                            <div class="map-search">
                                <input type="text" id="mapSearchInput" placeholder="Search for a location...">
                            </div>
                            <div class="selected-location">
                                <p>Selected: <span id="selectedLocationText">None</span></p>
                            </div>
                            <button id="confirmLocationBtn" class="submit">Confirm Location</button>
                        </div>
                    </div>
                    <script>
                        document.getElementById("loginBtn").addEventListener("click", function () {
                            window.location.href = "/login_page";
                        });

                        document.getElementById("registerBtn").addEventListener("click", function () {
                            window.location.href = "/register_page";
                        });

                        document.getElementById("logoutBtn").addEventListener("click", function () {
                            fetch("/logout")
                                .then(response => response.json())
                                .then(data => {
                                    alert(data.message);
                                    window.location.reload();
                                });
                        });
                    </script>

                    <script>
                        fetch("/check_session")
                            .then(response => response.json())
                            .then(data => {
                                if (data.logged_in) {
                                    document.getElementById("userInfo")?.classList.remove("hidden");
                                    const userSpan = document.getElementById("username");
                                    if (userSpan) userSpan.textContent = data.user;
                                    const loginBtn = document.getElementById("loginBtn");
                                    if (loginBtn) loginBtn.style.display = "none";
                                    const regBtn = document.getElementById("registerBtn");
                                    if (regBtn) regBtn.style.display = "none";
                                }
                            });
                    </script>

                    <script>
                        document.addEventListener("DOMContentLoaded", function () {
                            const slider = document.getElementById("uiPropertyAge");
                            const output = document.getElementById("propertyAgeValue");
                            if (slider && output) {
                                output.innerText = slider.value;
                                slider.addEventListener("input", function () {
                                    output.innerText = this.value;
                                });
                            }
                            console.log("ðŸ“¢ Bangalore Property Predictor Loaded!");
                        });
                    </script>

                    <div class="footer">
                        <p>Â© 2026 Bangalore Property Predictor | Powered by Intelligent ML</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
</body>

</html>